@page "/jobs"

<MudGrid Justify="Justify.Center">
    <MudItem xs="12" Class="pa-8">

        <MudGrid Justify="Justify.FlexStart">
            <MudItem xs="7">
                <MudPaper Elevation="4" Class="grey lighten-4 pa-7 red-text text-darken-2">

                    <MudGrid>

                        <MudItem xs="7">
                            <MudText Typo="Typo.h4"> Jobs </MudText>
                        </MudItem>

                        <MudItem xs="5" Class="d-flex justify-end">
                            <MudButton Variant="Variant.Filled" Size="Size.Medium" Class="red darken-2 white-text" OnClick="@OpenAddJob"> Add </MudButton>
                        </MudItem>

                        <MudItem xs="12">
                            <MudTable Hover="true" Items="@jobs" Breakpoint="Breakpoint.Sm" Loading="@loading" LoadingProgressColor="Color.Error">
                                <HeaderContent>
                                    <MudTh> Id </MudTh>
                                    <MudTh> Description </MudTh>
                                    <MudTh> Department </MudTh>
                                    <MudTh> Actions  </MudTh>
                                </HeaderContent>

                                <RowTemplate>
                                    <MudTd DataLabel="Id"> @context.Id</MudTd>
                                    <MudTd DataLabel="Description">@context.Description</MudTd>
                                    <MudTd DataLabel="Department">@context.DepartmentId</MudTd>
                                    <MudTd DataLabel="Action">0</MudTd>
                                </RowTemplate>

                                <PagerContent>
                                    <MudTablePager />
                                </PagerContent>

                            </MudTable>
                        </MudItem>

                    </MudGrid>

                </MudPaper>
            </MudItem>
        </MudGrid>

    </MudItem>
</MudGrid>

@code {

    [Inject]
    public IDialogService DialogService { get; set; }

    [Inject]
    public IJobService JobService{ get; set; }

    private List<Job> jobs { get; set; }
    private bool loading = true;

    // load jobs, once loaded loading the animation stops
    protected async override Task OnInitializedAsync()
    {
        jobs = (await JobService.GetJobs()).ToList();
        Console.WriteLine(jobs);
        loading = false;
    }

    private void OpenAddJob()
    {
        var parameters = new DialogParameters();
        parameters.Add("FieldName", "Description");

        DialogService.Show<AddUpdateSimple>("Add Job", parameters);
    }
}
